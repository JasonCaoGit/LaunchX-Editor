{"version":3,"sources":["vs/editor/contrib/inlineCompletions/browser/view/inlineEdits/wordReplacementView.ts"],"names":[],"mappings":"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","file":"wordReplacementView.js","sourceRoot":"file:///Users/kw/github/monaco-editor-core/out-editor-esm","sourcesContent":["/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\n\nimport { Disposable, toDisposable } from '../../../../../../base/common/lifecycle.js';\nimport { constObservable, derived, mapObservableArrayCached } from '../../../../../../base/common/observable.js';\nimport { editorHoverStatusBarBackground } from '../../../../../../platform/theme/common/colorRegistry.js';\nimport { registerColor, transparent } from '../../../../../../platform/theme/common/colorUtils.js';\nimport { ObservableCodeEditor } from '../../../../../browser/observableCodeEditor.js';\nimport { Rect } from '../../../../../browser/rect.js';\nimport { LineSource, renderLines, RenderOptions } from '../../../../../browser/widget/diffEditor/components/diffEditorViewZones/renderLines.js';\nimport { EditorOption } from '../../../../../common/config/editorOptions.js';\nimport { SingleOffsetEdit } from '../../../../../common/core/offsetEdit.js';\nimport { OffsetRange } from '../../../../../common/core/offsetRange.js';\nimport { SingleTextEdit } from '../../../../../common/core/textEdit.js';\nimport { ILanguageService } from '../../../../../common/languages/language.js';\nimport { LineTokens } from '../../../../../common/tokens/lineTokens.js';\nimport { TokenArray } from '../../../../../common/tokens/tokenArray.js';\nimport { getPrefixTrim, mapOutFalsy, n, rectToProps } from './utils.js';\nimport { localize } from '../../../../../../nls.js';\nimport { IInlineEditsView } from './sideBySideDiff.js';\nimport { Range } from '../../../../../common/core/range.js';\nimport { LineRange } from '../../../../../common/core/lineRange.js';\nimport { InlineDecoration, InlineDecorationType } from '../../../../../common/viewModel.js';\nimport { IModelDecorationOptions, TrackedRangeStickiness } from '../../../../../common/model.js';\nimport { $ } from '../../../../../../base/browser/dom.js';\nimport { observableValue } from '../../../../../../base/common/observableInternal/base.js';\nimport { IViewZoneChangeAccessor } from '../../../../../browser/editorBrowser.js';\nexport const transparentHoverBackground = registerColor(\n\t'inlineEdit.wordReplacementView.background',\n\t{\n\t\tlight: transparent(editorHoverStatusBarBackground, 0.1),\n\t\tdark: transparent(editorHoverStatusBarBackground, 0.1),\n\t\thcLight: transparent(editorHoverStatusBarBackground, 0.1),\n\t\thcDark: transparent(editorHoverStatusBarBackground, 0.1),\n\t},\n\tlocalize('inlineEdit.wordReplacementView.background', 'Background color for the inline edit word replacement view.')\n);\n\nexport class WordReplacementView extends Disposable implements IInlineEditsView {\n\n\tpublic static MAX_LENGTH = 100;\n\n\tprivate readonly _start = this._editor.observePosition(constObservable(this._edit.range.getStartPosition()), this._store);\n\tprivate readonly _end = this._editor.observePosition(constObservable(this._edit.range.getEndPosition()), this._store);\n\n\tprivate readonly _line = document.createElement('div');\n\n\tprivate readonly _text = derived(reader => {\n\t\tconst tm = this._editor.model.get()!;\n\t\tconst origLine = tm.getLineContent(this._edit.range.startLineNumber);\n\n\t\tconst edit = SingleOffsetEdit.replace(new OffsetRange(this._edit.range.startColumn - 1, this._edit.range.endColumn - 1), this._edit.text);\n\t\tconst lineToTokenize = edit.apply(origLine);\n\t\tconst t = tm.tokenization.tokenizeLinesAt(this._edit.range.startLineNumber, [lineToTokenize])?.[0];\n\t\tlet tokens: LineTokens;\n\t\tif (t) {\n\t\t\ttokens = TokenArray.fromLineTokens(t).slice(edit.getRangeAfterApply()).toLineTokens(this._edit.text, this._languageService.languageIdCodec);\n\t\t} else {\n\t\t\ttokens = LineTokens.createEmpty(this._edit.text, this._languageService.languageIdCodec);\n\t\t}\n\t\trenderLines(new LineSource([tokens]), RenderOptions.fromEditor(this._editor.editor).withSetWidth(false), [], this._line, true);\n\t});\n\n\tprivate readonly _editLocations = mapObservableArrayCached(this, constObservable(this._innerEdits), (edit, store) => {\n\t\tconst start = this._editor.observePosition(constObservable(edit.range.getStartPosition()), store);\n\t\tconst end = this._editor.observePosition(constObservable(edit.range.getEndPosition()), store);\n\t\treturn { start, end, edit };\n\t}).recomputeInitiallyAndOnChange(this._store);\n\n\tprivate readonly _layout = derived(this, reader => {\n\t\tthis._text.read(reader);\n\t\tconst widgetStart = this._start.read(reader);\n\t\tconst widgetEnd = this._end.read(reader);\n\n\t\tif (!widgetStart || !widgetEnd || widgetStart.x > widgetEnd.x) {\n\t\t\treturn undefined;\n\t\t}\n\n\t\tconst contentLeft = this._editor.layoutInfoContentLeft.read(reader);\n\t\tconst lineHeight = this._editor.getOption(EditorOption.lineHeight).read(reader);\n\t\tconst scrollLeft = this._editor.scrollLeft.read(reader);\n\t\tconst w = this._editor.getOption(EditorOption.fontInfo).read(reader).typicalHalfwidthCharacterWidth;\n\t\tconst modifiedLeftOffset = 20;\n\t\tconst modifiedTopOffset = 5;\n\t\tconst PADDING = 4;\n\n\t\tconst originalLine = Rect.fromLeftTopWidthHeight(widgetStart.x + contentLeft - scrollLeft, widgetStart.y, widgetEnd.x - widgetStart.x, lineHeight);\n\t\tconst modifiedLine = Rect.fromLeftTopWidthHeight(originalLine.left + modifiedLeftOffset, originalLine.top + lineHeight + modifiedTopOffset, this._edit.text.length * w + 5, originalLine.height);\n\t\tconst background = Rect.hull([originalLine, modifiedLine]).withMargin(PADDING);\n\n\t\tlet textLengthDelta = 0;\n\t\tconst editLocations = this._editLocations.read(reader);\n\t\tconst innerEdits = [];\n\t\tfor (const editLocation of editLocations) {\n\t\t\tconst editStart = editLocation.start.read(reader);\n\t\t\tconst editEnd = editLocation.end.read(reader);\n\t\t\tconst edit = editLocation.edit;\n\n\t\t\tif (!editStart || !editEnd || editStart.x > editEnd.x) {\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tconst original = Rect.fromLeftTopWidthHeight(editStart.x + contentLeft - scrollLeft, editStart.y, editEnd.x - editStart.x, lineHeight);\n\t\t\tconst modified = Rect.fromLeftTopWidthHeight(original.left + modifiedLeftOffset + textLengthDelta * w, original.top + lineHeight + modifiedTopOffset, edit.text.length * w + 5, original.height);\n\n\t\t\ttextLengthDelta += edit.text.length - (edit.range.endColumn - edit.range.startColumn);\n\n\t\t\tinnerEdits.push({ original, modified });\n\t\t}\n\n\t\tconst lowerBackground = background.intersectVertical(new OffsetRange(originalLine.bottom, Number.MAX_SAFE_INTEGER));\n\t\tconst lowerText = new Rect(lowerBackground.left + modifiedLeftOffset + 6, lowerBackground.top + modifiedTopOffset, lowerBackground.right, lowerBackground.bottom); // TODO: left seems slightly off? zooming?\n\n\t\treturn {\n\t\t\toriginalLine,\n\t\t\tmodifiedLine,\n\t\t\tbackground,\n\t\t\tinnerEdits,\n\t\t\tlowerBackground,\n\t\t\tlowerText,\n\t\t\tpadding: PADDING\n\t\t};\n\t});\n\n\tprivate readonly _div = n.div({\n\t\tclass: 'word-replacement',\n\t}, [\n\t\tderived(reader => {\n\t\t\tconst layout = mapOutFalsy(this._layout).read(reader);\n\t\t\tif (!layout) {\n\t\t\t\treturn [];\n\t\t\t}\n\n\t\t\tconst layoutProps = layout.read(reader);\n\t\t\tconst scrollLeft = this._editor.scrollLeft.read(reader);\n\t\t\tlet contentLeft = this._editor.layoutInfoContentLeft.read(reader);\n\t\t\tlet contentWidth = this._editor.contentWidth.read(reader);\n\t\t\tconst contentHeight = this._editor.editor.getContentHeight();\n\n\t\t\tif (scrollLeft === 0) {\n\t\t\t\tcontentLeft -= layoutProps.padding;\n\t\t\t\tcontentWidth += layoutProps.padding;\n\t\t\t}\n\n\t\t\tconst edits = layoutProps.innerEdits.map(edit => ({ modified: edit.modified.moveLeft(contentLeft), original: edit.original.moveLeft(contentLeft) }));\n\n\t\t\treturn [\n\t\t\t\tn.div({\n\t\t\t\t\tstyle: {\n\t\t\t\t\t\tposition: 'absolute',\n\t\t\t\t\t\ttop: 0,\n\t\t\t\t\t\tleft: contentLeft,\n\t\t\t\t\t\twidth: contentWidth,\n\t\t\t\t\t\theight: contentHeight,\n\t\t\t\t\t\toverflow: 'hidden',\n\t\t\t\t\t\tpointerEvents: 'none',\n\t\t\t\t\t}\n\t\t\t\t}, [\n\t\t\t\t\tn.div({\n\t\t\t\t\t\tstyle: {\n\t\t\t\t\t\t\tposition: 'absolute',\n\t\t\t\t\t\t\t...rectToProps(reader => layout.read(reader).lowerBackground.moveLeft(contentLeft)),\n\t\t\t\t\t\t\tborderRadius: '4px',\n\t\t\t\t\t\t\tbackground: 'var(--vscode-editor-background)',\n\t\t\t\t\t\t\tboxShadow: 'var(--vscode-scrollbar-shadow) 0 6px 6px -6px'\n\t\t\t\t\t\t},\n\t\t\t\t\t}, []),\n\t\t\t\t\tn.div({\n\t\t\t\t\t\tstyle: {\n\t\t\t\t\t\t\tposition: 'absolute',\n\t\t\t\t\t\t\tpadding: '0px',\n\t\t\t\t\t\t\tboxSizing: 'border-box',\n\t\t\t\t\t\t\t...rectToProps(reader => layout.read(reader).lowerText.moveLeft(contentLeft)),\n\t\t\t\t\t\t\tfontFamily: this._editor.getOption(EditorOption.fontFamily),\n\t\t\t\t\t\t\tfontSize: this._editor.getOption(EditorOption.fontSize),\n\t\t\t\t\t\t\tfontWeight: this._editor.getOption(EditorOption.fontWeight),\n\t\t\t\t\t\t\tpointerEvents: 'none',\n\t\t\t\t\t\t}\n\t\t\t\t\t}, [this._line]),\n\t\t\t\t\t...edits.map(edit => n.div({\n\t\t\t\t\t\tstyle: {\n\t\t\t\t\t\t\tposition: 'absolute',\n\t\t\t\t\t\t\ttop: edit.modified.top,\n\t\t\t\t\t\t\tleft: edit.modified.left,\n\t\t\t\t\t\t\twidth: edit.modified.width,\n\t\t\t\t\t\t\theight: edit.modified.height,\n\t\t\t\t\t\t\tborderRadius: '4px',\n\n\t\t\t\t\t\t\tbackground: 'var(--vscode-inlineEdit-modifiedChangedTextBackground)',\n\t\t\t\t\t\t\tpointerEvents: 'none',\n\t\t\t\t\t\t}\n\t\t\t\t\t}), []),\n\t\t\t\t\t...edits.map(edit => n.div({\n\t\t\t\t\t\tstyle: {\n\t\t\t\t\t\t\tposition: 'absolute',\n\t\t\t\t\t\t\ttop: edit.original.top,\n\t\t\t\t\t\t\tleft: edit.original.left,\n\t\t\t\t\t\t\twidth: edit.original.width,\n\t\t\t\t\t\t\theight: edit.original.height,\n\t\t\t\t\t\t\tborderRadius: '4px',\n\t\t\t\t\t\t\tboxSizing: 'border-box',\n\t\t\t\t\t\t\tbackground: 'var(--vscode-inlineEdit-originalChangedTextBackground)',\n\t\t\t\t\t\t\tpointerEvents: 'none',\n\t\t\t\t\t\t}\n\t\t\t\t\t}, [])),\n\t\t\t\t\tn.div({\n\t\t\t\t\t\tstyle: {\n\t\t\t\t\t\t\tposition: 'absolute',\n\t\t\t\t\t\t\t...rectToProps(reader => layout.read(reader).background.moveLeft(contentLeft)),\n\t\t\t\t\t\t\tborderRadius: '4px',\n\n\t\t\t\t\t\t\tborder: '1px solid var(--vscode-editorHoverWidget-border)',\n\t\t\t\t\t\t\t//background: 'rgba(122, 122, 122, 0.12)', looks better\n\t\t\t\t\t\t\tbackground: 'var(--vscode-inlineEdit-wordReplacementView-background)',\n\t\t\t\t\t\t\tpointerEvents: 'none',\n\t\t\t\t\t\t\tboxSizing: 'border-box',\n\t\t\t\t\t\t}\n\t\t\t\t\t}, []),\n\n\t\t\t\t\tn.svg({\n\t\t\t\t\t\twidth: 11,\n\t\t\t\t\t\theight: 13,\n\t\t\t\t\t\tviewBox: '0 0 11 13',\n\t\t\t\t\t\tfill: 'none',\n\t\t\t\t\t\tstyle: {\n\t\t\t\t\t\t\tposition: 'absolute',\n\t\t\t\t\t\t\tleft: derived(reader => layout.read(reader).modifiedLine.moveLeft(contentLeft).left - 15),\n\t\t\t\t\t\t\ttop: derived(reader => layout.read(reader).modifiedLine.top),\n\t\t\t\t\t\t}\n\t\t\t\t\t}, [\n\t\t\t\t\t\tn.svgElem('path', {\n\t\t\t\t\t\t\td: 'M1 0C1 2.98966 1 4.92087 1 7.49952C1 8.60409 1.89543 9.5 3 9.5H10.5',\n\t\t\t\t\t\t\tstroke: 'var(--vscode-editorHoverWidget-foreground)',\n\t\t\t\t\t\t}),\n\t\t\t\t\t\tn.svgElem('path', {\n\t\t\t\t\t\t\td: 'M6 6.5L9.99999 9.49998L6 12.5',\n\t\t\t\t\t\t\tstroke: 'var(--vscode-editorHoverWidget-foreground)',\n\t\t\t\t\t\t})\n\t\t\t\t\t]),\n\n\t\t\t\t])\n\t\t\t];\n\t\t})\n\t]).keepUpdated(this._store);\n\n\treadonly isHovered = derived(this, reader => {\n\t\treturn this._div.getIsHovered(this._store).read(reader);\n\t});\n\n\tconstructor(\n\t\tprivate readonly _editor: ObservableCodeEditor,\n\t\t/** Must be single-line in both sides */\n\t\tprivate readonly _edit: SingleTextEdit,\n\t\tprivate readonly _innerEdits: SingleTextEdit[],\n\t\t@ILanguageService private readonly _languageService: ILanguageService,\n\t) {\n\t\tsuper();\n\n\t\tthis._register(this._editor.createOverlayWidget({\n\t\t\tdomNode: this._div.element,\n\t\t\tminContentWidthInPx: constObservable(0),\n\t\t\tposition: constObservable({ preference: { top: 0, left: 0 } }),\n\t\t\tallowEditorOverflow: false,\n\t\t}));\n\t}\n}\n\nexport class LineReplacementView extends Disposable implements IInlineEditsView {\n\n\tprivate readonly _originalBubblesDecorationCollection = this._editor.editor.createDecorationsCollection();\n\tprivate readonly _originalBubblesDecorationOptions: IModelDecorationOptions = {\n\t\tdescription: 'inlineCompletions-original-bubble',\n\t\tclassName: 'inlineCompletions-original-bubble',\n\t\tstickiness: TrackedRangeStickiness.NeverGrowsWhenTypingAtEdges\n\t};\n\n\tprivate readonly _maxPrefixTrim = getPrefixTrim(this._replacements.flatMap(r => [r.originalRange, r.modifiedRange]), this._originalRange, this._modifiedLines, this._editor.editor);\n\n\tprivate readonly _modifiedLineElements = derived(reader => {\n\t\tconst lines = [];\n\t\tlet requiredWidth = 0;\n\n\t\tconst maxPrefixTrim = this._maxPrefixTrim.prefixTrim;\n\t\tconst modifiedBubbles = rangesToBubbleRanges(this._replacements.map(r => r.modifiedRange)).map(r => new Range(r.startLineNumber, r.startColumn - maxPrefixTrim, r.endLineNumber, r.endColumn - maxPrefixTrim));\n\n\t\tconst textModel = this._editor.model.get()!;\n\t\tconst startLineNumber = this._modifiedRange.startLineNumber;\n\t\tfor (let i = 0; i < this._modifiedRange.length; i++) {\n\t\t\tconst line = document.createElement('div');\n\t\t\tconst lineNumber = startLineNumber + i;\n\t\t\tconst modLine = this._modifiedLines[i].replace(/\\t\\n/g, '').slice(maxPrefixTrim);\n\n\t\t\tconst t = textModel.tokenization.tokenizeLinesAt(lineNumber, [modLine])?.[0];\n\t\t\tlet tokens: LineTokens;\n\t\t\tif (t) {\n\t\t\t\ttokens = TokenArray.fromLineTokens(t).toLineTokens(modLine, this._languageService.languageIdCodec);\n\t\t\t} else {\n\t\t\t\ttokens = LineTokens.createEmpty(modLine, this._languageService.languageIdCodec);\n\t\t\t}\n\n\t\t\tconst decorations = [];\n\t\t\tfor (const modified of modifiedBubbles.filter(b => b.startLineNumber === lineNumber)) {\n\t\t\t\tconst validatedEndColumn = Math.min(modified.endColumn, modLine.length + 1);\n\t\t\t\tdecorations.push(new InlineDecoration(new Range(1, modified.startColumn, 1, validatedEndColumn), 'inlineCompletions-modified-bubble', InlineDecorationType.Regular));\n\t\t\t\tdecorations.push(new InlineDecoration(new Range(1, modified.startColumn, 1, modified.startColumn + 1), 'start', InlineDecorationType.Regular));\n\t\t\t\tdecorations.push(new InlineDecoration(new Range(1, validatedEndColumn - 1, 1, validatedEndColumn), 'end', InlineDecorationType.Regular));\n\t\t\t}\n\n\t\t\tconst result = renderLines(new LineSource([tokens]), RenderOptions.fromEditor(this._editor.editor).withSetWidth(false), decorations, line, true);\n\n\t\t\trequiredWidth = Math.max(requiredWidth, result.minWidthInPx);\n\n\t\t\tlines.push(line);\n\t\t}\n\n\t\treturn { lines, requiredWidth: requiredWidth - 10 }; // TODO: Width is always too large, why?\n\t});\n\n\tprivate readonly _viewZoneInfo = observableValue<{ height: number; lineNumber: number } | undefined>('viewZoneInfo', undefined);\n\n\tprivate readonly _layout = derived(this, reader => {\n\t\tconst { requiredWidth } = this._modifiedLineElements.read(reader);\n\n\t\tconst lineHeight = this._editor.getOption(EditorOption.lineHeight).read(reader);\n\t\tconst contentLeft = this._editor.layoutInfoContentLeft.read(reader);\n\t\tconst scrollLeft = this._editor.scrollLeft.read(reader);\n\t\tconst scrollTop = this._editor.scrollTop.read(reader);\n\t\tconst editorLeftOffset = contentLeft - scrollLeft;\n\t\tconst PADDING = 4;\n\n\t\tconst textModel = this._editor.editor.getModel()!;\n\t\tconst { prefixLeftOffset } = this._maxPrefixTrim;\n\n\t\tconst originalLineWidths = this._originalRange.mapToLineArray(line => this._editor.editor.getOffsetForColumn(line, textModel.getLineMaxColumn(line)) - prefixLeftOffset);\n\t\tconst maxLineWidth = Math.max(...originalLineWidths, requiredWidth);\n\n\t\tconst startLineNumber = this._originalRange.startLineNumber;\n\t\tconst endLineNumber = this._originalRange.endLineNumberExclusive - 1;\n\t\tconst topOfOriginalLines = this._editor.editor.getTopForLineNumber(startLineNumber) - scrollTop;\n\t\tconst bottomOfOriginalLines = this._editor.editor.getBottomForLineNumber(endLineNumber) - scrollTop;\n\n\t\t// Box Widget positioning\n\t\tconst originalLinesOverlay = Rect.fromLeftTopWidthHeight(\n\t\t\teditorLeftOffset + prefixLeftOffset,\n\t\t\ttopOfOriginalLines,\n\t\t\tmaxLineWidth,\n\t\t\tbottomOfOriginalLines - topOfOriginalLines + PADDING\n\t\t);\n\t\tconst modifiedLinesOverlay = Rect.fromLeftTopWidthHeight(\n\t\t\toriginalLinesOverlay.left,\n\t\t\toriginalLinesOverlay.bottom + PADDING,\n\t\t\toriginalLinesOverlay.width,\n\t\t\tthis._modifiedRange.length * lineHeight\n\t\t);\n\t\tconst background = Rect.hull([originalLinesOverlay, modifiedLinesOverlay]).withMargin(PADDING);\n\n\t\tconst lowerBackground = background.intersectVertical(new OffsetRange(originalLinesOverlay.bottom, Number.MAX_SAFE_INTEGER));\n\t\tconst lowerText = new Rect(lowerBackground.left + PADDING, lowerBackground.top + PADDING, lowerBackground.right, lowerBackground.bottom);\n\n\t\t// Add ViewZone if needed\n\t\tconst shouldShowViewZone = this._editor.editor.getOption(EditorOption.inlineSuggest).edits.codeShifting;\n\t\tif (shouldShowViewZone) {\n\t\t\tconst viewZoneHeight = lowerBackground.height + 2 * PADDING;\n\t\t\tconst viewZoneLineNumber = this._originalRange.endLineNumberExclusive;\n\t\t\tconst activeViewZone = this._viewZoneInfo.get();\n\t\t\tif (!activeViewZone || activeViewZone.lineNumber !== viewZoneLineNumber || activeViewZone.height !== viewZoneHeight) {\n\t\t\t\tthis._viewZoneInfo.set({ height: viewZoneHeight, lineNumber: viewZoneLineNumber }, undefined);\n\t\t\t}\n\t\t} else if (this._viewZoneInfo.get()) {\n\t\t\tthis._viewZoneInfo.set(undefined, undefined);\n\t\t}\n\n\t\treturn {\n\t\t\toriginalLinesOverlay,\n\t\t\tmodifiedLinesOverlay,\n\t\t\tbackground,\n\t\t\tlowerBackground,\n\t\t\tlowerText,\n\t\t\tpadding: PADDING,\n\t\t\tminContentWidthRequired: maxLineWidth + PADDING * 2,\n\t\t};\n\t});\n\n\tprivate _previousViewZoneInfo: { height: number; lineNumber: number; id: string } | undefined = undefined;\n\tprotected readonly _viewZone = derived(this, reader => {\n\t\tconst viewZoneInfo = this._viewZoneInfo.read(reader);\n\t\tthis._editor.editor.changeViewZones((changeAccessor) => {\n\t\t\tthis.removePreviousViewZone(changeAccessor);\n\t\t\tif (!viewZoneInfo) { return; }\n\t\t\tthis.addViewZone(viewZoneInfo, changeAccessor);\n\t\t});\n\t}).recomputeInitiallyAndOnChange(this._store);\n\n\tprivate removePreviousViewZone(changeAccessor: IViewZoneChangeAccessor) {\n\t\tif (!this._previousViewZoneInfo) {\n\t\t\treturn;\n\t\t}\n\n\t\tchangeAccessor.removeZone(this._previousViewZoneInfo.id);\n\n\t\tconst cursorLineNumber = this._editor.cursorLineNumber.get();\n\t\tif (cursorLineNumber !== null && cursorLineNumber >= this._previousViewZoneInfo.lineNumber) {\n\t\t\tthis._editor.editor.setScrollTop(this._editor.scrollTop.get() - this._previousViewZoneInfo.height);\n\t\t}\n\n\t\tthis._previousViewZoneInfo = undefined;\n\t}\n\n\tprivate addViewZone(viewZoneInfo: { height: number; lineNumber: number }, changeAccessor: IViewZoneChangeAccessor) {\n\t\tconst activeViewZone = changeAccessor.addZone({\n\t\t\tafterLineNumber: viewZoneInfo.lineNumber - 1,\n\t\t\theightInPx: viewZoneInfo.height, // move computation to layout?\n\t\t\tdomNode: $('div'),\n\t\t});\n\n\t\tconst cursorLineNumber = this._editor.cursorLineNumber.get();\n\t\tif (cursorLineNumber !== null && cursorLineNumber >= viewZoneInfo.lineNumber) {\n\t\t\tthis._editor.editor.setScrollTop(this._editor.scrollTop.get() + viewZoneInfo.height);\n\t\t}\n\n\t\tthis._previousViewZoneInfo = { height: viewZoneInfo.height, lineNumber: viewZoneInfo.lineNumber, id: activeViewZone };\n\t}\n\n\tprivate readonly _div = n.div({\n\t\tclass: 'line-replacement',\n\t}, [\n\t\tderived(reader => {\n\t\t\tconst layout = mapOutFalsy(this._layout).read(reader);\n\t\t\tif (!layout) {\n\t\t\t\treturn [];\n\t\t\t}\n\n\t\t\tconst layoutProps = layout.read(reader);\n\t\t\tconst scrollLeft = this._editor.scrollLeft.read(reader);\n\t\t\tlet contentLeft = this._editor.layoutInfoContentLeft.read(reader);\n\t\t\tlet contentWidth = this._editor.contentWidth.read(reader);\n\t\t\tconst contentHeight = this._editor.editor.getContentHeight();\n\n\t\t\tif (scrollLeft === 0) {\n\t\t\t\tcontentLeft -= layoutProps.padding;\n\t\t\t\tcontentWidth += layoutProps.padding;\n\t\t\t}\n\n\t\t\tconst lineHeight = this._editor.getOption(EditorOption.lineHeight).read(reader);\n\t\t\tconst modifiedLines = this._modifiedLineElements.read(reader).lines;\n\t\t\tmodifiedLines.forEach(l => {\n\t\t\t\tl.style.width = `${layout.read(reader).lowerText.width}px`;\n\t\t\t\tl.style.height = `${lineHeight}px`;\n\t\t\t\tl.style.position = 'relative';\n\t\t\t});\n\n\t\t\treturn [\n\t\t\t\tn.div({\n\t\t\t\t\tstyle: {\n\t\t\t\t\t\tposition: 'absolute',\n\t\t\t\t\t\ttop: 0,\n\t\t\t\t\t\tleft: contentLeft,\n\t\t\t\t\t\twidth: contentWidth,\n\t\t\t\t\t\theight: contentHeight,\n\t\t\t\t\t\toverflow: 'hidden',\n\t\t\t\t\t\tpointerEvents: 'none',\n\t\t\t\t\t}\n\t\t\t\t}, [\n\t\t\t\t\tn.div({ // overlay to make sure the code is not visible between original and modified lines\n\t\t\t\t\t\tstyle: {\n\t\t\t\t\t\t\tposition: 'absolute',\n\t\t\t\t\t\t\ttop: layoutProps.lowerBackground.top - layoutProps.padding,\n\t\t\t\t\t\t\tleft: layoutProps.lowerBackground.left - contentLeft,\n\t\t\t\t\t\t\twidth: layoutProps.lowerBackground.width,\n\t\t\t\t\t\t\theight: layoutProps.padding * 2,\n\t\t\t\t\t\t\tbackground: 'var(--vscode-editor-background)',\n\t\t\t\t\t\t},\n\t\t\t\t\t}),\n\t\t\t\t\tn.div({ // styling for the modified lines widget\n\t\t\t\t\t\tstyle: {\n\t\t\t\t\t\t\tposition: 'absolute',\n\t\t\t\t\t\t\t...rectToProps(reader => layout.read(reader).lowerBackground.moveLeft(contentLeft)),\n\t\t\t\t\t\t\tborderRadius: '4px',\n\t\t\t\t\t\t\tbackground: 'var(--vscode-editor-background)',\n\t\t\t\t\t\t\tboxShadow: 'var(--vscode-scrollbar-shadow) 0 6px 6px -6px',\n\t\t\t\t\t\t\tborderTop: '1px solid var(--vscode-editorHoverWidget-border)',\n\t\t\t\t\t\t\toverflow: 'hidden',\n\t\t\t\t\t\t},\n\t\t\t\t\t}, [\n\t\t\t\t\t\tn.div({ // adds background color to modified lines widget (may be transparent)\n\t\t\t\t\t\t\tstyle: {\n\t\t\t\t\t\t\t\tposition: 'absolute',\n\t\t\t\t\t\t\t\ttop: 0,\n\t\t\t\t\t\t\t\tleft: 0,\n\t\t\t\t\t\t\t\twidth: '100%',\n\t\t\t\t\t\t\t\theight: '100%',\n\t\t\t\t\t\t\t\tbackground: 'var(--vscode-inlineEdit-modifiedChangedLineBackground)',\n\t\t\t\t\t\t\t},\n\t\t\t\t\t\t})\n\t\t\t\t\t]),\n\t\t\t\t\tn.div({\n\t\t\t\t\t\tstyle: {\n\t\t\t\t\t\t\tposition: 'absolute',\n\t\t\t\t\t\t\tpadding: '0px',\n\t\t\t\t\t\t\tboxSizing: 'border-box',\n\t\t\t\t\t\t\t...rectToProps(reader => layout.read(reader).lowerText.moveLeft(contentLeft)),\n\t\t\t\t\t\t\tfontFamily: this._editor.getOption(EditorOption.fontFamily),\n\t\t\t\t\t\t\tfontSize: this._editor.getOption(EditorOption.fontSize),\n\t\t\t\t\t\t\tfontWeight: this._editor.getOption(EditorOption.fontWeight),\n\t\t\t\t\t\t\tpointerEvents: 'none',\n\t\t\t\t\t\t}\n\t\t\t\t\t}, [...modifiedLines]),\n\t\t\t\t\tn.div({\n\t\t\t\t\t\tstyle: {\n\t\t\t\t\t\t\tposition: 'absolute',\n\t\t\t\t\t\t\t...rectToProps(reader => layout.read(reader).background.moveLeft(contentLeft)),\n\t\t\t\t\t\t\tborderRadius: '4px',\n\n\t\t\t\t\t\t\tborder: '1px solid var(--vscode-editorHoverWidget-border)',\n\t\t\t\t\t\t\t//background: 'rgba(122, 122, 122, 0.12)', looks better\n\t\t\t\t\t\t\tbackground: 'var(--vscode-inlineEdit-wordReplacementView-background)',\n\t\t\t\t\t\t\tpointerEvents: 'none',\n\t\t\t\t\t\t\tboxSizing: 'border-box',\n\t\t\t\t\t\t}\n\t\t\t\t\t}, []),\n\t\t\t\t])\n\t\t\t];\n\t\t})\n\t]).keepUpdated(this._store);\n\n\treadonly isHovered = derived(this, reader => {\n\t\treturn this._div.getIsHovered(this._store).read(reader);\n\t});\n\n\tconstructor(\n\t\tprivate readonly _editor: ObservableCodeEditor,\n\t\tprivate readonly _originalRange: LineRange,\n\t\tprivate readonly _modifiedRange: LineRange,\n\t\tprivate readonly _modifiedLines: string[],\n\t\tprivate readonly _replacements: readonly Replacement[],\n\t\t@ILanguageService private readonly _languageService: ILanguageService,\n\t) {\n\t\tsuper();\n\n\t\tthis._register(toDisposable(() => this._originalBubblesDecorationCollection.clear()));\n\t\tthis._register(toDisposable(() => this._editor.editor.changeViewZones(accessor => this.removePreviousViewZone(accessor))));\n\n\t\tconst originalBubbles = rangesToBubbleRanges(this._replacements.map(r => r.originalRange));\n\t\tthis._originalBubblesDecorationCollection.set(originalBubbles.map(r => ({ range: r, options: this._originalBubblesDecorationOptions })));\n\n\t\tthis._register(this._editor.createOverlayWidget({\n\t\t\tdomNode: this._div.element,\n\t\t\tminContentWidthInPx: derived(reader => { // TODO: is this helping?\n\t\t\t\treturn this._layout.read(reader)?.minContentWidthRequired ?? 0;\n\t\t\t}),\n\t\t\tposition: constObservable({ preference: { top: 0, left: 0 } }),\n\t\t\tallowEditorOverflow: false,\n\t\t}));\n\t}\n}\n\nfunction rangesToBubbleRanges(ranges: Range[]): Range[] {\n\tconst result: Range[] = [];\n\twhile (ranges.length) {\n\t\tlet range = ranges.shift()!;\n\t\tif (range.startLineNumber !== range.endLineNumber) {\n\t\t\tranges.push(new Range(range.startLineNumber + 1, 1, range.endLineNumber, range.endColumn));\n\t\t\trange = new Range(range.startLineNumber, range.startColumn, range.startLineNumber, Number.MAX_SAFE_INTEGER); // TODO: this is not correct\n\t\t}\n\n\t\tresult.push(range);\n\t}\n\treturn result;\n\n}\n\nexport interface Replacement {\n\toriginalRange: Range;\n\tmodifiedRange: Range;\n}\n"]}